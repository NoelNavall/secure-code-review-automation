{
  "scan_date": "2026-01-12 12:45:55",
  "total_findings": 16,
  "summary": {
    "CRITICAL": 3,
    "HIGH": 5,
    "MEDIUM": 8,
    "LOW": 0
  },
  "findings": [
    {
      "tool": "bandit",
      "severity": "CRITICAL",
      "title": "hardcoded_sql_expressions",
      "message": "Possible SQL injection vector through string-based query construction.",
      "file": ".\\sample\\app.py",
      "line": 27,
      "code": "26     cursor = conn.cursor()\n27     query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n28     cursor.execute(query)  # BUG: Direct string interpolation\n",
      "cwe": [
        89
      ],
      "llm_analysis": {
        "raw_response": "Error calling LM Studio: 'choices'"
      }
    },
    {
      "tool": "bandit",
      "severity": "CRITICAL",
      "title": "hardcoded_sql_expressions",
      "message": "Possible SQL injection vector through string-based query construction.",
      "file": ".\\sample\\app.py",
      "line": 89,
      "code": "88     cursor = conn.cursor()\n89     cursor.execute(f\"DELETE FROM users WHERE id={user_id}\")\n90     conn.commit()\n",
      "cwe": [
        89
      ],
      "llm_analysis": {
        "raw_response": "Error calling LM Studio: 'choices'"
      }
    },
    {
      "tool": "bandit",
      "severity": "CRITICAL",
      "title": "hardcoded_sql_expressions",
      "message": "Possible SQL injection vector through string-based query construction.",
      "file": ".\\sample\\app.py",
      "line": 126,
      "code": "125     # Storing password in plaintext\n126     cursor.execute(f\"INSERT INTO users VALUES ('{username}', '{password}')\")  # BUG: No hashing\n127     conn.commit()\n",
      "cwe": [
        89
      ],
      "llm_analysis": {
        "raw_response": "Error calling LM Studio: 'choices'"
      }
    },
    {
      "tool": "bandit",
      "severity": "HIGH",
      "title": "subprocess_popen_with_shell_equals_true",
      "message": "subprocess call with shell=True identified, security issue.",
      "file": ".\\sample\\app.py",
      "line": 41,
      "code": "40     # Vulnerable to command injection\n41     result = subprocess.check_output(f\"ping -c 1 {host}\", shell=True)  # BUG: shell=True with user input\n42     return result\n",
      "cwe": [
        78
      ],
      "llm_analysis": {
        "raw_response": "Error calling LM Studio: 'choices'"
      }
    },
    {
      "tool": "bandit",
      "severity": "HIGH",
      "title": "hashlib",
      "message": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "file": ".\\sample\\app.py",
      "line": 78,
      "code": "77     # Vulnerable: Using MD5 for security\n78     hashed = hashlib.md5(data.encode()).hexdigest()  # BUG: MD5 is cryptographically broken\n79     return hashed\n",
      "cwe": [
        327
      ],
      "llm_analysis": {
        "raw_response": "Error calling LM Studio: 'choices'"
      }
    },
    {
      "tool": "bandit",
      "severity": "HIGH",
      "title": "flask_debug_true",
      "message": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
      "file": ".\\sample\\app.py",
      "line": 156,
      "code": "155     # VULNERABILITY: Debug mode in production\n156     app.run(debug=True, host='0.0.0.0')  # BUG: debug=True exposes stack traces\n",
      "cwe": [
        94
      ]
    },
    {
      "tool": "bandit",
      "severity": "HIGH",
      "title": "blacklist",
      "message": "The pyCrypto library and its module DES are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.",
      "file": ".\\sample\\utils.py",
      "line": 126,
      "code": "125 def encrypt_data(data):\n126     from Crypto.Cipher import DES  # BUG: DES is deprecated\n127     key = b'8bytekey'\n",
      "cwe": [
        327
      ],
      "llm_analysis": {
        "raw_response": "Error calling LM Studio: 'choices'"
      }
    },
    {
      "tool": "bandit",
      "severity": "HIGH",
      "title": "blacklist",
      "message": "Use of insecure cipher Crypto.Cipher.DES.new. Replace with a known secure cipher such as AES.",
      "file": ".\\sample\\utils.py",
      "line": 128,
      "code": "127     key = b'8bytekey'\n128     cipher = DES.new(key, DES.MODE_ECB)\n129     return cipher.encrypt(data)\n",
      "cwe": [
        327
      ],
      "llm_analysis": {
        "raw_response": "Error calling LM Studio: 'choices'"
      }
    },
    {
      "tool": "bandit",
      "severity": "MEDIUM",
      "title": "blacklist",
      "message": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
      "file": ".\\sample\\app.py",
      "line": 68,
      "code": "67     # Vulnerable to insecure deserialization\n68     obj = pickle.loads(data)  # BUG: Unpickling untrusted data\n69     return str(obj)\n",
      "cwe": [
        502
      ],
      "llm_analysis": {
        "raw_response": "Error calling LM Studio: 'choices'"
      }
    },
    {
      "tool": "bandit",
      "severity": "MEDIUM",
      "title": "request_without_timeout",
      "message": "Call to requests without timeout",
      "file": ".\\sample\\app.py",
      "line": 101,
      "code": "100     # Vulnerable to SSRF\n101     response = requests.get(url)  # BUG: No URL validation\n102     return response.text\n",
      "cwe": [
        400
      ],
      "llm_analysis": {
        "raw_response": "Error calling LM Studio: 'choices'"
      }
    },
    {
      "tool": "bandit",
      "severity": "MEDIUM",
      "title": "blacklist",
      "message": "Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called",
      "file": ".\\sample\\app.py",
      "line": 151,
      "code": "150     # Vulnerable to XXE\n151     tree = ET.fromstring(xml_data)  # BUG: No XXE protection\n152     return tree.text\n",
      "cwe": [
        20
      ],
      "llm_analysis": {
        "raw_response": "Error calling LM Studio: 'choices'"
      }
    },
    {
      "tool": "bandit",
      "severity": "MEDIUM",
      "title": "hardcoded_bind_all_interfaces",
      "message": "Possible binding to all interfaces.",
      "file": ".\\sample\\app.py",
      "line": 156,
      "code": "155     # VULNERABILITY: Debug mode in production\n156     app.run(debug=True, host='0.0.0.0')  # BUG: debug=True exposes stack traces\n",
      "cwe": [
        605
      ]
    },
    {
      "tool": "bandit",
      "severity": "MEDIUM",
      "title": "hardcoded_tmp_directory",
      "message": "Probable insecure usage of temp file/directory.",
      "file": ".\\sample\\utils.py",
      "line": 29,
      "code": "28     # Race condition vulnerability\n29     filename = f\"/tmp/myapp_{random.randint(1000, 9999)}.txt\"  # BUG: predictable filename\n30     with open(filename, 'w') as f:\n",
      "cwe": [
        377
      ]
    },
    {
      "tool": "bandit",
      "severity": "MEDIUM",
      "title": "yaml_load",
      "message": "Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().",
      "file": ".\\sample\\utils.py",
      "line": 37,
      "code": "36     # Vulnerable to YAML deserialization attacks\n37     config = yaml.load(config_string)  # BUG: Should use yaml.safe_load()\n38     return config\n",
      "cwe": [
        20
      ]
    },
    {
      "tool": "bandit",
      "severity": "MEDIUM",
      "title": "blacklist",
      "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
      "file": ".\\sample\\utils.py",
      "line": 43,
      "code": "42     # Arbitrary code execution\n43     result = eval(expression)  # BUG: eval on user input\n44     return result\n",
      "cwe": [
        78
      ]
    },
    {
      "tool": "bandit",
      "severity": "MEDIUM",
      "title": "request_without_timeout",
      "message": "Call to requests without timeout",
      "file": ".\\sample\\utils.py",
      "line": 92,
      "code": "91     url = f\"http://api.example.com/users/{user_id}\"  # BUG: Unencrypted HTTP\n92     response = requests.get(url)\n93     return response.json()\n",
      "cwe": [
        400
      ]
    }
  ]
}