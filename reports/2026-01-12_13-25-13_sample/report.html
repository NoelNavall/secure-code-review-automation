<!DOCTYPE html>
<html>
<head>
    <title>Security Scan Report</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f0f0f0; 
        }
        .header { 
            background: #333; 
            color: white; 
            padding: 20px; 
            border-radius: 5px; 
        }
        .summary { 
            display: flex; 
            gap: 10px; 
            margin: 20px 0; 
        }
        .stat { 
            background: white; 
            padding: 15px; 
            border-radius: 5px; 
            flex: 1; 
            text-align: center;
            cursor: pointer;
        }
        .stat:hover { 
            background: #e0e0e0; 
        }
        .stat.active { 
            border: 2px solid #0066cc;
            background: #e6f2ff;
        }
        .stat.critical { border-left: 5px solid #d32f2f; }
        .stat.high { border-left: 5px solid #f57c00; }
        .stat.medium { border-left: 5px solid #fbc02d; }
        .stat.low { border-left: 5px solid #388e3c; }
        
        .finding { 
            background: white; 
            padding: 15px; 
            margin: 15px 0; 
            border-radius: 5px; 
        }
        .finding.hidden { 
            display: none; 
        }
        .finding.CRITICAL { border-left: 5px solid #d32f2f; }
        .finding.HIGH { border-left: 5px solid #f57c00; }
        .finding.MEDIUM { border-left: 5px solid #fbc02d; }
        .finding.LOW { border-left: 5px solid #388e3c; }
        
        .severity { 
            display: inline-block; 
            padding: 5px 10px; 
            border-radius: 3px; 
            color: white; 
            font-weight: bold;
        }
        .severity.CRITICAL { background: #d32f2f; }
        .severity.HIGH { background: #f57c00; }
        .severity.MEDIUM { background: #fbc02d; }
        .severity.LOW { background: #388e3c; }
        
        code { 
            background: #2b2b2b; 
            color: #f8f8f8; 
            padding: 10px; 
            display: block; 
            border-radius: 3px; 
            overflow-x: auto; 
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre;
        }
        
        .info { 
            background: #e8f5e9; 
            border: 1px solid #c8e6c9; 
            padding: 10px; 
            border-radius: 3px; 
            margin: 10px 0; 
        }
        
        .warning {
            background: #fff3e0;
            border: 1px solid #ffb74d;
            padding: 10px;
            border-radius: 3px;
            margin: 10px 0;
        }
        
        .location { 
            color: #666; 
            font-size: 0.9em; 
        }
        
        h3 { 
            margin-top: 0; 
        }
        
        .filter-info {
            text-align: center;
            color: #666;
            margin: 10px 0;
            font-style: italic;
        }
        
        .pagination {
            text-align: center;
            margin: 20px 0;
        }
        
        .page-btn {
            padding: 8px 12px;
            margin: 0 5px;
            border: 1px solid #ccc;
            background: white;
            cursor: pointer;
            border-radius: 3px;
        }
        
        .page-btn:hover {
            background: #e0e0e0;
        }
        
        .page-btn.active {
            background: #0066cc;
            color: white;
            border-color: #0066cc;
        }
    </style>
    <script>
        // Simple filtering and pagination
        let activeFilters = new Set();
        let currentPage = 1;
        const itemsPerPage = 20;
        
        function toggleFilter(severity) {
            if (activeFilters.has(severity)) {
                activeFilters.delete(severity);
            } else {
                activeFilters.add(severity);
            }
            
            // Update button styles
            document.querySelectorAll('.stat').forEach(btn => {
                btn.classList.remove('active');
            });
            activeFilters.forEach(sev => {
                document.querySelector('.stat.' + sev.toLowerCase()).classList.add('active');
            });
            
            currentPage = 1;
            applyFilters();
        }
        
        function applyFilters() {
            const findings = document.querySelectorAll('.finding');
            let visible = [];
            
            findings.forEach(finding => {
                const severity = finding.className.split(' ')[1];
                
                if (activeFilters.size === 0 || activeFilters.has(severity)) {
                    visible.push(finding);
                } else {
                    finding.classList.add('hidden');
                }
            });
            
            // Pagination
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            
            visible.forEach((finding, idx) => {
                if (idx >= start && idx < end) {
                    finding.classList.remove('hidden');
                } else {
                    finding.classList.add('hidden');
                }
            });
            
            updatePagination(visible.length);
        }
        
        function updatePagination(totalVisible) {
            const totalPages = Math.ceil(totalVisible / itemsPerPage);
            const paginationDiv = document.getElementById('pagination');
            
            let html = '';
            
            if (currentPage > 1) {
                html += '<button class="page-btn" onclick="changePage(' + (currentPage - 1) + ')">Previous</button>';
            }
            
            for (let i = 1; i <= totalPages; i++) {
                if (i === currentPage) {
                    html += '<button class="page-btn active">' + i + '</button>';
                } else {
                    html += '<button class="page-btn" onclick="changePage(' + i + ')">' + i + '</button>';
                }
            }
            
            if (currentPage < totalPages) {
                html += '<button class="page-btn" onclick="changePage(' + (currentPage + 1) + ')">Next</button>';
            }
            
            paginationDiv.innerHTML = html;
        }
        
        function changePage(page) {
            currentPage = page;
            applyFilters();
        }
        
        // Run on page load
        window.onload = function() {
            applyFilters();
        };
    </script>
</head>
<body>
    <div class="header">
        <h1>Security Scan Report</h1>
        <p>Generated: 2026-01-12 13:26:51</p>
    </div>
    
    <div class="summary">
        <div class="stat critical" onclick="toggleFilter('CRITICAL')">
            <h2>6</h2>
            <p>Critical</p>
        </div>
        <div class="stat high" onclick="toggleFilter('HIGH')">
            <h2>5</h2>
            <p>High</p>
        </div>
        <div class="stat medium" onclick="toggleFilter('MEDIUM')">
            <h2>5</h2>
            <p>Medium</p>
        </div>
        <div class="stat low" onclick="toggleFilter('LOW')">
            <h2>0</h2>
            <p>Low</p>
        </div>
    </div>
    
    
    <div id="pagination" class="pagination"></div>
    
    <div id="findings">

    <div class="finding CRITICAL">
        <h3>1. hardcoded_sql_expressions</h3>
        <span class="severity CRITICAL">CRITICAL</span>
        <p class="location">File: .\sample\app.py (line 27) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Possible SQL injection vector through string-based query construction.</p>
        
        <h4>Code:</h4>
        <code>      24      # Vulnerable to SQL injection
      25      conn = sqlite3.connect('users.db')
      26      cursor = conn.cursor()
>>>   27      query = f"SELECT * FROM users WHERE username='{username}' AND password='{password}'"  ← BUG HERE
      28      cursor.execute(query)  # BUG: Direct string interpolation
      29      user = cursor.fetchone()
      30  </code>

        <h4>Impact:</h4>
        <p>Full compromise of user accounts and potential data exfiltration.</p>

        <h4>How easy to exploit:</h4>
        <p>5/5</p>

        <div class="info">
            <h4>How to fix (AI-generated):</h4>
            <p>Use parameterized queries:
query = "SELECT * FROM users WHERE username=%s AND password=%s"
cursor.execute(query, (username,password))</p>
        </div>
    </div>

    <div class="finding CRITICAL">
        <h3>2. subprocess_popen_with_shell_equals_true</h3>
        <span class="severity CRITICAL">CRITICAL</span>
        <p class="location">File: .\sample\app.py (line 41) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>subprocess call with shell=True identified, security issue.</p>
        
        <h4>Code:</h4>
        <code>      38      host = request.args.get('host', 'localhost')
      39  
      40      # Vulnerable to command injection
>>>   41      result = subprocess.check_output(f"ping -c 1 {host}", shell=True)  # BUG: shell=True with user input  ← BUG HERE
      42      return result
      43  
      44  # VULNERABILITY: Path Traversal</code>

        <h4>Impact:</h4>
        <p>An attacker can inject arbitrary shell commands via the 'host' parameter, potentially leading to remote code execution and full system compromise.</p>

        <h4>How easy to exploit:</h4>
        <p>5/5</p>

        <div class="info">
            <h4>How to fix (AI-generated):</h4>
            <p>Use subprocess.check_output(['ping','-c','1', host]) without shell=True. Ensure 'host' is validated or sanitized before use.</p>
        </div>
    </div>

    <div class="finding CRITICAL">
        <h3>3. blacklist</h3>
        <span class="severity CRITICAL">CRITICAL</span>
        <p class="location">File: .\sample\app.py (line 68) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.</p>
        
        <h4>Code:</h4>
        <code>      65      data = request.data
      66  
      67      # Vulnerable to insecure deserialization
>>>   68      obj = pickle.loads(data)  # BUG: Unpickling untrusted data  ← BUG HERE
      69      return str(obj)
      70  
      71  # VULNERABILITY: Weak Cryptography</code>

        <h4>Impact:</h4>
        <p>Arbitrary code execution leading to full system compromise, data theft, or denial of service.</p>

        <h4>How easy to exploit:</h4>
        <p>5/5</p>

        <div class="info">
            <h4>How to fix (AI-generated):</h4>
            <p>import json
obj = json.loads(data)  # Use safe JSON deserialization instead of pickle</p>
        </div>
    </div>

    <div class="finding CRITICAL">
        <h3>4. hardcoded_sql_expressions</h3>
        <span class="severity CRITICAL">CRITICAL</span>
        <p class="location">File: .\sample\app.py (line 89) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Possible SQL injection vector through string-based query construction.</p>
        
        <h4>Code:</h4>
        <code>      86      # No authentication check!
      87      conn = sqlite3.connect('users.db')
      88      cursor = conn.cursor()
>>>   89      cursor.execute(f"DELETE FROM users WHERE id={user_id}")  ← BUG HERE
      90      conn.commit()
      91  
      92      return "User deleted"</code>

        <h4>Impact:</h4>
        <p>An attacker can delete arbitrary user records or all users by injecting SQL through the user_id parameter, leading to data loss and potential denial of service.</p>

        <h4>How easy to exploit:</h4>
        <p>5/5</p>

        <div class="info">
            <h4>How to fix (AI-generated):</h4>
            <p>cursor.execute("DELETE FROM users WHERE id=%s", (user_id,))</p>
        </div>
    </div>

    <div class="finding CRITICAL">
        <h3>5. hardcoded_sql_expressions</h3>
        <span class="severity CRITICAL">CRITICAL</span>
        <p class="location">File: .\sample\app.py (line 126) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Possible SQL injection vector through string-based query construction.</p>
        
        <h4>Code:</h4>
        <code>     123      conn = sqlite3.connect('users.db')
     124      cursor = conn.cursor()
     125      # Storing password in plaintext
>>>  126      cursor.execute(f"INSERT INTO users VALUES ('{username}', '{password}')")  # BUG: No hashing  ← BUG HERE
     127      conn.commit()
     128  
     129  # VULNERABILITY: Race Condition</code>

        <h4>Impact:</h4>
        <p>Full database compromise: attacker can inject arbitrary SQL, read/write/delete data, exfiltrate sensitive information, and potentially gain administrative control over the system.</p>

        <h4>How easy to exploit:</h4>
        <p>5/5</p>

        <div class="info">
            <h4>How to fix (AI-generated):</h4>
            <p>```python
hashed_pw = hash_password(password)
cursor.execute("INSERT INTO users (username, password) VALUES (%s, %s)", (username, hashed_pw))
```</p>
        </div>
    </div>

    <div class="finding CRITICAL">
        <h3>6. blacklist</h3>
        <span class="severity CRITICAL">CRITICAL</span>
        <p class="location">File: .\sample\utils.py (line 128) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Use of insecure cipher Crypto.Cipher.DES.new. Replace with a known secure cipher such as AES.</p>
        
        <h4>Code:</h4>
        <code>     125  def encrypt_data(data):
     126      from Crypto.Cipher import DES  # BUG: DES is deprecated
     127      key = b'8bytekey'
>>>  128      cipher = DES.new(key, DES.MODE_ECB)  ← BUG HERE
     129      return cipher.encrypt(data)
     130  
     131  # VULNERABILITY: No CSRF protection</code>

        <h4>Impact:</h4>
        <p>Data confidentiality loss due to weak DES encryption, enabling attackers to decrypt sensitive information and potentially inject malicious data.</p>

        <h4>How easy to exploit:</h4>
        <p>4/5</p>

        <div class="info">
            <h4>How to fix (AI-generated):</h4>
            <p>from Crypto.Cipher import AES
key = hashlib.sha256(b'secret_passphrase').digest()[:32]
cipher = AES.new(key, AES.MODE_ECB)</p>
        </div>
    </div>

    <div class="finding HIGH">
        <h3>7. hashlib</h3>
        <span class="severity HIGH">HIGH</span>
        <p class="location">File: .\sample\app.py (line 78) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Use of weak MD5 hash for security. Consider usedforsecurity=False</p>
        
        <h4>Code:</h4>
        <code>      75      data = request.form['data']
      76  
      77      # Vulnerable: Using MD5 for security
>>>   78      hashed = hashlib.md5(data.encode()).hexdigest()  # BUG: MD5 is cryptographically broken  ← BUG HERE
      79      return hashed
      80  
      81  # VULNERABILITY: Missing Authentication</code>

        <h4>Impact:</h4>
        <p>An attacker can generate hash collisions or preimage attacks, enabling credential forgery, tampering of data integrity checks, or bypassing authentication mechanisms that rely on this MD5 hash.</p>

        <h4>How easy to exploit:</h4>
        <p>4/5</p>

        <div class="info">
            <h4>How to fix (AI-generated):</h4>
            <p>Replace with a stronger hash: 
hashed = hashlib.sha256(data.encode()).hexdigest()  # Use SHA-256 for security
# Or use bcrypt/scrypt for password hashing if applicable</p>
        </div>
    </div>

    <div class="finding HIGH">
        <h3>8. request_without_timeout</h3>
        <span class="severity HIGH">HIGH</span>
        <p class="location">File: .\sample\app.py (line 101) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Call to requests without timeout</p>
        
        <h4>Code:</h4>
        <code>      98      url = request.args.get('url')
      99  
     100      # Vulnerable to SSRF
>>>  101      response = requests.get(url)  # BUG: No URL validation  ← BUG HERE
     102      return response.text
     103  
     104  # VULNERABILITY: Information Disclosure</code>

        <h4>Impact:</h4>
        <p>An attacker could exploit the lack of timeout and URL validation to perform Server-Side Request Forgery (SSRF), potentially accessing internal resources, exfiltrating data, or causing denial-of-service by hanging requests.</p>

        <h4>How easy to exploit:</h4>
        <p>4/5</p>

        <div class="info">
            <h4>How to fix (AI-generated):</h4>
            <p>response = requests.get(url, timeout=5)  # Add reasonable timeout
# Validate the URL against a whitelist of allowed domains before calling
if not is_allowed_url(url): raise ValueError('Disallowed URL')</p>
        </div>
    </div>

    <div class="finding HIGH">
        <h3>9. blacklist</h3>
        <span class="severity HIGH">HIGH</span>
        <p class="location">File: .\sample\app.py (line 151) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called</p>
        
        <h4>Code:</h4>
        <code>     148      xml_data = request.data
     149  
     150      # Vulnerable to XXE
>>>  151      tree = ET.fromstring(xml_data)  # BUG: No XXE protection  ← BUG HERE
     152      return tree.text
     153  
     154  if __name__ == '__main__':</code>

        <h4>Impact:</h4>
        <p>An attacker could trigger XML External Entity (XXE) attacks, leading to arbitrary file disclosure, server-side request forgery, or denial of service on the host system.</p>

        <h4>How easy to exploit:</h4>
        <p>4/5</p>

        <div class="info">
            <h4>How to fix (AI-generated):</h4>
            <p>from defusedxml import ElementTree as ET
ET.defuse_stdlib()
# then use ET.fromstring(xml_data)</p>
        </div>
    </div>

    <div class="finding HIGH">
        <h3>10. flask_debug_true</h3>
        <span class="severity HIGH">HIGH</span>
        <p class="location">File: .\sample\app.py (line 156) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.</p>
        
        <h4>Code:</h4>
        <code>     153  
     154  if __name__ == '__main__':
     155      # VULNERABILITY: Debug mode in production
>>>  156      app.run(debug=True, host='0.0.0.0')  # BUG: debug=True exposes stack traces  ← BUG HERE</code>

        <div class="warning">
            <h4>How to fix (basic guidance):</h4>
            <p>Review the code and apply security best practices for this vulnerability type</p>
            <small><em>Note: LLM analysis not available. Run with --llm-top-k for detailed AI-powered remediation.</em></small>
        </div>
    </div>

    <div class="finding HIGH">
        <h3>11. blacklist</h3>
        <span class="severity HIGH">HIGH</span>
        <p class="location">File: .\sample\utils.py (line 126) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>The pyCrypto library and its module DES are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.</p>
        
        <h4>Code:</h4>
        <code>     123  
     124  # VULNERABILITY: Old cryptographic algorithm
     125  def encrypt_data(data):
>>>  126      from Crypto.Cipher import DES  # BUG: DES is deprecated  ← BUG HERE
     127      key = b'8bytekey'
     128      cipher = DES.new(key, DES.MODE_ECB)
     129      return cipher.encrypt(data)</code>

        <h4>Impact:</h4>
        <p>Use of deprecated DES exposes encrypted data to known vulnerabilities and weak key management, potentially allowing attackers to decrypt or forge ciphertexts, leading to confidentiality and integrity breaches.</p>

        <h4>How easy to exploit:</h4>
        <p>4/5</p>

        <div class="info">
            <h4>How to fix (AI-generated):</h4>
            <p>from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
key = b'16bytekey123456'
cipher = Cipher(algorithms.AES(key), modes.ECB())
enc = cipher.encryptor()</p>
        </div>
    </div>

    <div class="finding MEDIUM">
        <h3>12. hardcoded_bind_all_interfaces</h3>
        <span class="severity MEDIUM">MEDIUM</span>
        <p class="location">File: .\sample\app.py (line 156) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Possible binding to all interfaces.</p>
        
        <h4>Code:</h4>
        <code>     153  
     154  if __name__ == '__main__':
     155      # VULNERABILITY: Debug mode in production
>>>  156      app.run(debug=True, host='0.0.0.0')  # BUG: debug=True exposes stack traces  ← BUG HERE</code>

        <div class="warning">
            <h4>How to fix (basic guidance):</h4>
            <p>Store secrets in environment variables or a secrets manager, not in code</p>
            <small><em>Note: LLM analysis not available. Run with --llm-top-k for detailed AI-powered remediation.</em></small>
        </div>
    </div>

    <div class="finding MEDIUM">
        <h3>13. hardcoded_tmp_directory</h3>
        <span class="severity MEDIUM">MEDIUM</span>
        <p class="location">File: .\sample\utils.py (line 29) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Probable insecure usage of temp file/directory.</p>
        
        <h4>Code:</h4>
        <code>      26  # VULNERABILITY: Insecure temporary file creation
      27  def create_temp_file(content):
      28      # Race condition vulnerability
>>>   29      filename = f"/tmp/myapp_{random.randint(1000, 9999)}.txt"  # BUG: predictable filename  ← BUG HERE
      30      with open(filename, 'w') as f:
      31          f.write(content)
      32      return filename</code>

        <div class="warning">
            <h4>How to fix (basic guidance):</h4>
            <p>Store secrets in environment variables or a secrets manager, not in code</p>
            <small><em>Note: LLM analysis not available. Run with --llm-top-k for detailed AI-powered remediation.</em></small>
        </div>
    </div>

    <div class="finding MEDIUM">
        <h3>14. yaml_load</h3>
        <span class="severity MEDIUM">MEDIUM</span>
        <p class="location">File: .\sample\utils.py (line 37) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().</p>
        
        <h4>Code:</h4>
        <code>      34  # VULNERABILITY: YAML deserialization
      35  def load_config(config_string):
      36      # Vulnerable to YAML deserialization attacks
>>>   37      config = yaml.load(config_string)  # BUG: Should use yaml.safe_load()  ← BUG HERE
      38      return config
      39  
      40  # VULNERABILITY: Eval usage</code>

        <div class="warning">
            <h4>How to fix (basic guidance):</h4>
            <p>Review the code and apply security best practices for this vulnerability type</p>
            <small><em>Note: LLM analysis not available. Run with --llm-top-k for detailed AI-powered remediation.</em></small>
        </div>
    </div>

    <div class="finding MEDIUM">
        <h3>15. blacklist</h3>
        <span class="severity MEDIUM">MEDIUM</span>
        <p class="location">File: .\sample\utils.py (line 43) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Use of possibly insecure function - consider using safer ast.literal_eval.</p>
        
        <h4>Code:</h4>
        <code>      40  # VULNERABILITY: Eval usage
      41  def calculate(expression):
      42      # Arbitrary code execution
>>>   43      result = eval(expression)  # BUG: eval on user input  ← BUG HERE
      44      return result
      45  
      46  # VULNERABILITY: Timing attack</code>

        <div class="warning">
            <h4>How to fix (basic guidance):</h4>
            <p>Never use eval() on user input. Use ast.literal_eval() for safe evaluation</p>
            <small><em>Note: LLM analysis not available. Run with --llm-top-k for detailed AI-powered remediation.</em></small>
        </div>
    </div>

    <div class="finding MEDIUM">
        <h3>16. request_without_timeout</h3>
        <span class="severity MEDIUM">MEDIUM</span>
        <p class="location">File: .\sample\utils.py (line 92) | Found by: bandit</p>
        
        <h4>What's wrong:</h4>
        <p>Call to requests without timeout</p>
        
        <h4>Code:</h4>
        <code>      89  def fetch_user_data(user_id):
      90      import requests
      91      url = f"http://api.example.com/users/{user_id}"  # BUG: Unencrypted HTTP
>>>   92      response = requests.get(url)  ← BUG HERE
      93      return response.json()
      94  
      95  # VULNERABILITY: No input validation</code>

        <div class="warning">
            <h4>How to fix (basic guidance):</h4>
            <p>Add timeout parameter: requests.get(url, timeout=5)</p>
            <small><em>Note: LLM analysis not available. Run with --llm-top-k for detailed AI-powered remediation.</em></small>
        </div>
    </div>

    </div>
    
    <div id="pagination-bottom" class="pagination"></div>

</body>
</html>
