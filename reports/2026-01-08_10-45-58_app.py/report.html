<!DOCTYPE html>
<html>
<head>
    <title>Security Scan Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .header { background: #2c3e50; color: white; padding: 20px; border-radius: 5px; }
        .summary { display: flex; gap: 15px; margin: 20px 0; }
        .stat { 
            background: white; 
            padding: 15px; 
            border-radius: 5px; 
            flex: 1; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .stat:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 4px 8px rgba(0,0,0,0.2); 
        }
        .stat.active { 
            box-shadow: 0 0 0 3px #3498db;
            transform: scale(1.05);
        }
        .stat.critical { border-left: 4px solid #e74c3c; }
        .stat.high { border-left: 4px solid #e67e22; }
        .stat.medium { border-left: 4px solid #f39c12; }
        .stat.low { border-left: 4px solid #3498db; }
        .stat.critical.active { border-left: 4px solid #e74c3c; background: #fee; }
        .stat.high.active { border-left: 4px solid #e67e22; background: #fef3e6; }
        .stat.medium.active { border-left: 4px solid #f39c12; background: #fef9e6; }
        .stat.low.active { border-left: 4px solid #3498db; background: #e6f3fe; }
        .finding { background: white; padding: 20px; margin: 15px 0; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.3s ease; }
        .finding.hidden { display: none; }
        .finding.CRITICAL { border-left: 5px solid #e74c3c; }
        .finding.HIGH { border-left: 5px solid #e67e22; }
        .finding.MEDIUM { border-left: 5px solid #f39c12; }
        .finding.LOW { border-left: 5px solid #3498db; }
        .severity { display: inline-block; padding: 5px 10px; border-radius: 3px; font-weight: bold; color: white; }
        .severity.CRITICAL { background: #e74c3c; }
        .severity.HIGH { background: #e67e22; }
        .severity.MEDIUM { background: #f39c12; }
        .severity.LOW { background: #3498db; }
        code { 
            background: #2d2d2d; 
            color: #f8f8f2; 
            padding: 15px; 
            display: block; 
            border-radius: 5px; 
            overflow-x: auto; 
            margin: 10px 0; 
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6;
        }
        .remediation { background: #d4edda; border: 1px solid #c3e6cb; padding: 10px; border-radius: 3px; margin: 10px 0; }
        .location { color: #7f8c8d; font-size: 0.9em; }
        .filter-hint { 
            text-align: center; 
            color: #7f8c8d; 
            font-size: 0.9em; 
            margin-top: 10px;
            font-style: italic;
        }
        .results-count {
            text-align: center;
            padding: 15px;
            background: #3498db;
            color: white;
            border-radius: 5px;
            margin: 20px 0;
            font-size: 1.1em;
            font-weight: bold;
        }
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .pagination-info {
            font-size: 1.1em;
            color: #2c3e50;
            font-weight: bold;
        }
        .pagination-buttons {
            display: flex;
            gap: 5px;
            align-items: center;
        }
        .page-btn {
            padding: 8px 15px;
            border: 1px solid #3498db;
            background: white;
            color: #3498db;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .page-btn:hover {
            background: #3498db;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .page-btn.active {
            background: #3498db;
            color: white;
            font-weight: bold;
        }
        .page-ellipsis {
            padding: 0 5px;
            color: #7f8c8d;
        }
        .findings-container {
            margin-bottom: 30px;
        }
    </style>
    <script>
        let activeFilters = new Set();
        let currentPage = 1;
        const itemsPerPage = 20;
        
        function toggleFilter(severity) {
            const stat = document.querySelector('.stat.' + severity.toLowerCase());
            
            if (activeFilters.has(severity)) {
                // Remove filter
                activeFilters.delete(severity);
                stat.classList.remove('active');
            } else {
                // Add filter
                activeFilters.add(severity);
                stat.classList.add('active');
            }
            
            currentPage = 1; // Reset to page 1 when filter changes
            applyFilters();
        }
        
        function applyFilters() {
            const findings = document.querySelectorAll('.finding');
            let visibleFindings = [];
            
            // First pass: determine which findings match filters
            findings.forEach(finding => {
                if (activeFilters.size === 0) {
                    visibleFindings.push(finding);
                } else {
                    let shouldShow = false;
                    activeFilters.forEach(filter => {
                        if (finding.classList.contains(filter)) {
                            shouldShow = true;
                        }
                    });
                    if (shouldShow) {
                        visibleFindings.push(finding);
                    }
                }
            });
            
            // Second pass: apply pagination
            const totalPages = Math.ceil(visibleFindings.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            
            findings.forEach(finding => finding.classList.add('hidden'));
            
            visibleFindings.forEach((finding, index) => {
                if (index >= startIndex && index < endIndex) {
                    finding.classList.remove('hidden');
                } else {
                    finding.classList.add('hidden');
                }
            });
            
            updateResultsCount(visibleFindings.length, findings.length);
            updatePagination(visibleFindings.length, totalPages);
        }
        
        function changePage(newPage) {
            currentPage = newPage;
            applyFilters();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function updatePagination(totalVisible, totalPages) {
            let paginationDiv = document.getElementById('pagination');
            if (!paginationDiv) {
                paginationDiv = document.createElement('div');
                paginationDiv.id = 'pagination';
                paginationDiv.className = 'pagination';
                document.querySelector('.findings-container').appendChild(paginationDiv);
            }
            
            if (totalPages <= 1) {
                paginationDiv.style.display = 'none';
                return;
            }
            
            paginationDiv.style.display = 'flex';
            
            let html = '<div class="pagination-info">Page ' + currentPage + ' of ' + totalPages + '</div>';
            html += '<div class="pagination-buttons">';
            
            // Previous button
            if (currentPage > 1) {
                html += '<button onclick="changePage(' + (currentPage - 1) + ')" class="page-btn">← Previous</button>';
            }
            
            // Page numbers
            const maxButtons = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
            let endPage = Math.min(totalPages, startPage + maxButtons - 1);
            
            if (endPage - startPage < maxButtons - 1) {
                startPage = Math.max(1, endPage - maxButtons + 1);
            }
            
            if (startPage > 1) {
                html += '<button onclick="changePage(1)" class="page-btn">1</button>';
                if (startPage > 2) html += '<span class="page-ellipsis">...</span>';
            }
            
            for (let i = startPage; i <= endPage; i++) {
                if (i === currentPage) {
                    html += '<button class="page-btn active">' + i + '</button>';
                } else {
                    html += '<button onclick="changePage(' + i + ')" class="page-btn">' + i + '</button>';
                }
            }
            
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) html += '<span class="page-ellipsis">...</span>';
                html += '<button onclick="changePage(' + totalPages + ')" class="page-btn">' + totalPages + '</button>';
            }
            
            // Next button
            if (currentPage < totalPages) {
                html += '<button onclick="changePage(' + (currentPage + 1) + ')" class="page-btn">Next →</button>';
            }
            
            html += '</div>';
            paginationDiv.innerHTML = html;
        }
        
        function updateResultsCount(visible, total) {
            let resultsDiv = document.getElementById('results-count');
            if (!resultsDiv) {
                resultsDiv = document.createElement('div');
                resultsDiv.id = 'results-count';
                resultsDiv.className = 'results-count';
                document.querySelector('.summary').after(resultsDiv);
            }
            
            const totalPages = Math.ceil(visible / itemsPerPage);
            const startItem = (currentPage - 1) * itemsPerPage + 1;
            const endItem = Math.min(currentPage * itemsPerPage, visible);
            
            if (activeFilters.size === 0) {
                if (totalPages > 1) {
                    resultsDiv.textContent = `Showing ${startItem}-${endItem} of ${total} findings (Page ${currentPage}/${totalPages})`;
                } else {
                    resultsDiv.textContent = `Showing all ${total} findings`;
                }
                resultsDiv.style.background = '#3498db';
            } else {
                const filterNames = Array.from(activeFilters).join(' + ');
                if (totalPages > 1) {
                    resultsDiv.textContent = `Showing ${startItem}-${endItem} of ${visible} findings (${filterNames}) - Page ${currentPage}/${totalPages}`;
                } else {
                    resultsDiv.textContent = `Showing ${visible} of ${total} findings (${filterNames})`;
                }
                resultsDiv.style.background = '#2ecc71';
            }
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            applyFilters();
        });
    </script>
</head>
<body>
    <div class="header">
        <h1>Security Scan Report</h1>
        <p>Generated: 2026-01-08 10:46:19</p>
    </div>
    
    <div class="summary">
        <div class="stat critical" onclick="toggleFilter('CRITICAL')">
            <h3>3</h3>
            <p>Critical</p>
        </div>
        <div class="stat high" onclick="toggleFilter('HIGH')">
            <h3>3</h3>
            <p>High</p>
        </div>
        <div class="stat medium" onclick="toggleFilter('MEDIUM')">
            <h3>4</h3>
            <p>Medium</p>
        </div>
        <div class="stat low" onclick="toggleFilter('LOW')">
            <h3>0</h3>
            <p>Low</p>
        </div>
    </div>
 
    <div class="findings-container">
    <h2>Findings</h2>

    <div class="finding CRITICAL">
        <h3>1. hardcoded_sql_expressions</h3>
        <span class="severity CRITICAL">CRITICAL</span>
        <p class="location">File: .\.\sample\app.py:27 | Tool: bandit</p>
        
        <h4>Description</h4>
        <p>Possible SQL injection vector through string-based query construction.</p>
        
        <h4>Vulnerable Code</h4>
        <code style="white-space: pre; font-family: 'Courier New', monospace; line-height: 1.5;">    23  
    24      # Vulnerable to SQL injection
    25      conn = sqlite3.connect('users.db')
    26      cursor = conn.cursor()
➤   27      query = f"SELECT * FROM users WHERE username='{username}' AND password='{password}'"  ← VULNERABLE LINE
    28      cursor.execute(query)  # BUG: Direct string interpolation
    29      user = cursor.fetchone()
    30  
    31      if user:</code>
    </div>

    <div class="finding CRITICAL">
        <h3>2. hardcoded_sql_expressions</h3>
        <span class="severity CRITICAL">CRITICAL</span>
        <p class="location">File: .\.\sample\app.py:89 | Tool: bandit</p>
        
        <h4>Description</h4>
        <p>Possible SQL injection vector through string-based query construction.</p>
        
        <h4>Vulnerable Code</h4>
        <code style="white-space: pre; font-family: 'Courier New', monospace; line-height: 1.5;">    85  
    86      # No authentication check!
    87      conn = sqlite3.connect('users.db')
    88      cursor = conn.cursor()
➤   89      cursor.execute(f"DELETE FROM users WHERE id={user_id}")  ← VULNERABLE LINE
    90      conn.commit()
    91  
    92      return "User deleted"
    93  </code>
    </div>

    <div class="finding CRITICAL">
        <h3>3. hardcoded_sql_expressions</h3>
        <span class="severity CRITICAL">CRITICAL</span>
        <p class="location">File: .\.\sample\app.py:126 | Tool: bandit</p>
        
        <h4>Description</h4>
        <p>Possible SQL injection vector through string-based query construction.</p>
        
        <h4>Vulnerable Code</h4>
        <code style="white-space: pre; font-family: 'Courier New', monospace; line-height: 1.5;">   122  
   123      conn = sqlite3.connect('users.db')
   124      cursor = conn.cursor()
   125      # Storing password in plaintext
➤  126      cursor.execute(f"INSERT INTO users VALUES ('{username}', '{password}')")  # BUG: No hashing  ← VULNERABLE LINE
   127      conn.commit()
   128  
   129  # VULNERABILITY: Race Condition
   130  user_balance = 1000</code>
    </div>

    <div class="finding HIGH">
        <h3>4. subprocess_popen_with_shell_equals_true</h3>
        <span class="severity HIGH">HIGH</span>
        <p class="location">File: .\.\sample\app.py:41 | Tool: bandit</p>
        
        <h4>Description</h4>
        <p>subprocess call with shell=True identified, security issue.</p>
        
        <h4>Vulnerable Code</h4>
        <code style="white-space: pre; font-family: 'Courier New', monospace; line-height: 1.5;">    37  def ping():
    38      host = request.args.get('host', 'localhost')
    39  
    40      # Vulnerable to command injection
➤   41      result = subprocess.check_output(f"ping -c 1 {host}", shell=True)  # BUG: shell=True with user input  ← VULNERABLE LINE
    42      return result
    43  
    44  # VULNERABILITY: Path Traversal
    45  @app.route('/download', methods=['GET'])</code>
    </div>

    <div class="finding HIGH">
        <h3>5. hashlib</h3>
        <span class="severity HIGH">HIGH</span>
        <p class="location">File: .\.\sample\app.py:78 | Tool: bandit</p>
        
        <h4>Description</h4>
        <p>Use of weak MD5 hash for security. Consider usedforsecurity=False</p>
        
        <h4>Vulnerable Code</h4>
        <code style="white-space: pre; font-family: 'Courier New', monospace; line-height: 1.5;">    74      import hashlib
    75      data = request.form['data']
    76  
    77      # Vulnerable: Using MD5 for security
➤   78      hashed = hashlib.md5(data.encode()).hexdigest()  # BUG: MD5 is cryptographically broken  ← VULNERABLE LINE
    79      return hashed
    80  
    81  # VULNERABILITY: Missing Authentication
    82  @app.route('/admin/delete_user', methods=['POST'])</code>
    </div>

    <div class="finding HIGH">
        <h3>6. flask_debug_true</h3>
        <span class="severity HIGH">HIGH</span>
        <p class="location">File: .\.\sample\app.py:156 | Tool: bandit</p>
        
        <h4>Description</h4>
        <p>A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.</p>
        
        <h4>Vulnerable Code</h4>
        <code style="white-space: pre; font-family: 'Courier New', monospace; line-height: 1.5;">   152      return tree.text
   153  
   154  if __name__ == '__main__':
   155      # VULNERABILITY: Debug mode in production
➤  156      app.run(debug=True, host='0.0.0.0')  # BUG: debug=True exposes stack traces  ← VULNERABLE LINE</code>
    </div>

    <div class="finding MEDIUM">
        <h3>7. blacklist</h3>
        <span class="severity MEDIUM">MEDIUM</span>
        <p class="location">File: .\.\sample\app.py:68 | Tool: bandit</p>
        
        <h4>Description</h4>
        <p>Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.</p>
        
        <h4>Vulnerable Code</h4>
        <code style="white-space: pre; font-family: 'Courier New', monospace; line-height: 1.5;">    64  def load_data():
    65      data = request.data
    66  
    67      # Vulnerable to insecure deserialization
➤   68      obj = pickle.loads(data)  # BUG: Unpickling untrusted data  ← VULNERABLE LINE
    69      return str(obj)
    70  
    71  # VULNERABILITY: Weak Cryptography
    72  @app.route('/encrypt', methods=['POST'])</code>
    </div>

    <div class="finding MEDIUM">
        <h3>8. request_without_timeout</h3>
        <span class="severity MEDIUM">MEDIUM</span>
        <p class="location">File: .\.\sample\app.py:101 | Tool: bandit</p>
        
        <h4>Description</h4>
        <p>Call to requests without timeout</p>
        
        <h4>Vulnerable Code</h4>
        <code style="white-space: pre; font-family: 'Courier New', monospace; line-height: 1.5;">    97      import requests
    98      url = request.args.get('url')
    99  
   100      # Vulnerable to SSRF
➤  101      response = requests.get(url)  # BUG: No URL validation  ← VULNERABLE LINE
   102      return response.text
   103  
   104  # VULNERABILITY: Information Disclosure
   105  @app.route('/debug')</code>
    </div>

    <div class="finding MEDIUM">
        <h3>9. blacklist</h3>
        <span class="severity MEDIUM">MEDIUM</span>
        <p class="location">File: .\.\sample\app.py:151 | Tool: bandit</p>
        
        <h4>Description</h4>
        <p>Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called</p>
        
        <h4>Vulnerable Code</h4>
        <code style="white-space: pre; font-family: 'Courier New', monospace; line-height: 1.5;">   147      import xml.etree.ElementTree as ET
   148      xml_data = request.data
   149  
   150      # Vulnerable to XXE
➤  151      tree = ET.fromstring(xml_data)  # BUG: No XXE protection  ← VULNERABLE LINE
   152      return tree.text
   153  
   154  if __name__ == '__main__':
   155      # VULNERABILITY: Debug mode in production</code>
    </div>

    <div class="finding MEDIUM">
        <h3>10. hardcoded_bind_all_interfaces</h3>
        <span class="severity MEDIUM">MEDIUM</span>
        <p class="location">File: .\.\sample\app.py:156 | Tool: bandit</p>
        
        <h4>Description</h4>
        <p>Possible binding to all interfaces.</p>
        
        <h4>Vulnerable Code</h4>
        <code style="white-space: pre; font-family: 'Courier New', monospace; line-height: 1.5;">   152      return tree.text
   153  
   154  if __name__ == '__main__':
   155      # VULNERABILITY: Debug mode in production
➤  156      app.run(debug=True, host='0.0.0.0')  # BUG: debug=True exposes stack traces  ← VULNERABLE LINE</code>
    </div>

</body>
</html>
